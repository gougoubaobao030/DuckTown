本次遇到的问题以及解决方案
解决过程，有什么吐槽


### 2025年6月22日
### 问题
- 现在duckInteractState里写什么呢

### 思考
- 我们有一个待接入的交互系统
- 首先我们肯定是从哪个事件里接受到了信号
- 进了交互系统

- 交互状态下，禁止移动，禁止攻击

- 外部接受某外部信号，退出交互状态，进入idle状态。

---

- 拿去询问智障
- 智障给出代码和建议，但是看起来有点
- 把接口调用放在这里面

---

- 突然想到入口问题
- 是有目标 + 按下e键

``` 
if (HasInteractTarget() && Input.GetKeyDown(KeyCode.E))
{
    stateMachine.SwitchState(new DuckInteractState(stateMachine, currentTarget));
} 
```
那这个伟大hasinteractTarget()从哪里来呢

---
我想要观察一下之前这个伟大系统的代码

### 自己代码观察


### 智障代码观察

想顺便把交互系统文档写了
论file性质和接口的重要性（还没感觉到）

- 把抽出的问题问了智障，得到一个智障一样的回答

- 确认了整个交互系统的接入位置
- 确认了interacterSystem.interact()调用位置

**产生一个新问题**
交互系统都在做什么：
这应该是可以写入文章的第一个问题。

### 【学到了什么】
  - 状态驱动
    - 根据角色现在状态更新每一帧

### 等下做什么
- done 事件总线还是... 
- done 状态驱动区别 ...
  - 根据现在状态来跟新每一帧  
- soild 什么下级越级
- 写下之前的交互状态文档
- done 先叫智障写一个我好参照（笑）
- done 结合智障和代码，自己写一个文档
- done 复习之前学过的内容

**现在来整理一下最基本的进程顺序**
- 发送一个进入交互状态的信号
- duck注册
- ground 转换状态
- Interactor 调用 接口
- e要不要整合进input模块里面的问题

**我觉得文档比较要紧的点**
- 可以补充一个
- InteractableBase.cs
- 模块重新分类 
  - 大家都要用的拆出去
  - 不用的在交互系统里
  

### 2025年6月23日

**做了啥**
- 粗略给交互系统写了文档
- 记录各个文件功能
- 将文件放到了更加适合它们的位置
- 对照阅读了智障建议文档chatgpt
  
### 【棘手的问题】
- IInteractionSystem
- access to gamemanger
- IPlayer 接入Game Manger
- 问题，生成顺序会出问题，怎么办

**准备去做**
- 开始接入! 先研究event
    - 更改一下，先从controller接入
- 觉得升级架构交给gamemanger这个车暂时有点开过头
- 要是过头不如先接入对话系统
- 要是过头不如先接入任务系统

### 2025年6月24日

**实际存在问题**
- ❓e的UI虽然在显示，但如果上下帧更换了目标，其实没有针对目标刷新
- 💬
> 💬其实没有关系
> 因为不涉及具体对象的名字，头像等问题
> 实际点下去还是那个该有的对象

  ### 【发现问题】
- 第一次隐藏UI有效，而后又无效
  ### 【解决思路】
- 先接入devTool做个观察再说
- 怎么写dev模块也是个问题，正想加些忘记拖拽创建的判断。
- 可能是怎么结束上有问题⬇
- 似乎要接着看智障给的代码

# 发现一个bug
> 开着背包的时候，拾取物品物品不刷新

### 2025年6月25日
- 准备实装伟大的命令模式
- 有点想写一片关于对命令模式理解的文档
- 简单讲封装了不同交互行为...统一了结构

1. enum 状态，在interface新增mode属性
2. 修改实装具体类的公共接口get函数
3. IInteractCommand 内容待修改
4. 吃饭前的功夫把router做了
5. 在交互控制器生成router和要储存的命令
6. 在发现交互目标后通过router分发命令
7. 大功告成


- 【实装问题】：
- 暂时发现state的函数没有执行
- 发现是重复添加了oneshot命令
- 在router里新增一对一预防

- 【问题】
- tryInteract被两次调用，造成状态不一致
- 改用事件传参 + 缓存机制，
- 保证状态只对当前捕获目标负责

- 【实装问题】
-  点击事件时没有进入交互状态
-  原因： ui直接调用了交互方法没有进交互状态
-  解决方法： 抽出方法，并做和e按键同等判断，保证进入条件一致